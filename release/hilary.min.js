/*! little-hilary 2017-03-18 */
if(function(a){"use strict";!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"locale",factory:{errorTypes:{INVALID_ARG:"InvalidArgument",MODULE_NOT_FOUND:"ModuleNotFound"},container:{CONSUMER_REQUIRED:"A consumer function is required to `enumerate` over a container"},api:{REGISTER_ERR:"register failed. see cause for more information",REGISTER_ARG:"register expects either a hilary module, or an array of hilary modules as the first argument, but instead saw this: ",RESOLVE_ARG:"resolve expects a moduleName (string) as the first argument, but instead saw this: ",MODULE_NOT_FOUND:"The module, {{module}}, cannot be found, and is a dependency of, {{startingModule}}",MODULE_NOT_RESOLVABLE:"The module, {{module}}, cannot be resolved because of a dependency exception, causing a ripple effect for, {{startingModule}}",MODULE_UNDEFINED:"The following module was resolved but returned undefined: ",REGISTRATION_BLACK_LIST:"A module was registered with a reserved name: ",PARENT_CONTAINER_ARG:"setParentScope expects the name of the parent scope, or an instance of Hilary"}}})}(),function(a){"use strict";function b(a){return{isException:!0,type:a.type,error:a.error,messages:a.messages||[],data:a.data}}!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"Exception",factory:b})}(),function(a){"use strict";function b(a,b,c,d){return function(c){function e(){return m}function f(a){m[a.name]=a}function g(a){return m[a]}function h(a){return m.hasOwnProperty(a)}function i(c){var e;if(!b.function(c))return new d({type:a.errorTypes.INVALID_ARG,error:new Error(a.container.CONSUMER_REQUIRED)});for(e in m)m.hasOwnProperty(e)&&c(e,m[e])}function j(a){var c,d,e;if(b.string(a))return l.disposeOne(a);if(b.array(a)){for(e=!0,d=0;d<a.length;d+=1)e=e&&l.disposeOne(a[d]);return e}if(a)return!1;e=!0;for(c in m)m.hasOwnProperty(c)&&(e=e&&l.disposeOne(c));return e}function k(a){return!!m[a]&&(delete m[a],!0)}var l,m={};return c=c||{},l={get:e,register:f,resolve:c.makeResolveHandler?c.makeResolveHandler(g):g,exists:h,enumerate:i,dispose:j,disposeOne:k}}}!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"Container",factory:b})}(),function(a){"use strict";function b(a,b){var c=new a({__blueprintId:"Hilary::Context",scope:"string",parent:{type:"string",required:!1},container:"object",singletonContainer:"object"});return function(a){var d;return a=a||{},a.parent&&"string"!=typeof a.parent&&(a.parent=a.parent.name),d=new c({scope:a.scope,parent:a.parent,container:new b,singletonContainer:new b}),d.setParentScope=function(a){return c.merge({parent:a})},d}}!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"Context",factory:b})}(),function(a){"use strict";function b(a,b,c){var d=new b({__blueprintId:"Hilary::HilaryModule",name:"string",factory:{validate:function(a,b){a||b.push("This implementation does not satisfy blueprint, Hilary::HilaryModule. It should have the property, factory.")}},isHilaryModule:"boolean",singleton:{type:"boolean",required:!1},dependencies:{type:"array",required:!1}});return function(b){return b=b||{},b.isHilaryModule=!0,b.singleton=!a.boolean(b.singleton)||b.singleton,a.not.defined(b.dependencies)&&a.function(b.factory)&&(b.dependencies=c.getArgumentNames(b.factory)),new d(b)}}!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"HilaryModule",factory:b})}(),function(a){"use strict";function b(a){function b(b){var c;if(b="string"==typeof b?{}:b||{},b.logging=b.logging||{},b.logging.level&&a.string(b.logging.level))switch(b.logging.level){case"debug":c=20;break;case"info":c=30;break;case"warn":c=40;break;case"error":c=50;break;case"fatal":c=60;break;case"off":c=70;break;default:c=10}else c=b.logging.level&&a.number(b.logging.level)&&b.logging.level>0&&b.logging.level<=70?b.logging.level:30;return{level:c}}return function(a){function c(b,c){var d;if(!(b<a.level)){switch(b){case 60:d=console.error||console.log;break;case 50:d=console.error||console.log;break;case 40:d=console.warn||console.log;break;default:d=console.log}d.apply(null,c)}}var d={trace:function(){c(10,arguments)},debug:function(){c(20,arguments)},info:function(){c(30,arguments)},warn:function(){c(40,arguments)},error:function(){c(50,arguments)},fatal:function(){c(60,arguments)}};return a=new b(a),d}}!function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"Logger",factory:b})}(),function(a){"use strict";function b(a,b,k,l,m,n,o,p,q){var r,s,t={};return r=function(d){function e(a,c){var d=new Error(m.api.REGISTER_ERR);if(b.object(a))return g(a,d,c);if(b.array(a))return z(function(){return a.forEach(g),B},d,c);var e=new o({type:m.errorTypes.INVALID_ARG,error:new Error(m.api.REGISTER_ARG+JSON.stringify(a)),data:a});return D(e),e}function g(c,d,e){var g=[];if(g.push(function(a){var b=new q(c);b.isException?a(new o({type:m.errorTypes.INVALID_ARG,error:new Error(b.error.message),messages:b.messages})):a(null,b)}),g.push(function(a,b){if(j[a.name])return b(new o({type:m.errorTypes.INVALID_ARG,error:new Error(m.api.REGISTRATION_BLACK_LIST+a.name)}));b(null,a)}),g.push(function(a,b){a.name===f&&(E=null),b(null,a)}),g.push(function(a,b){C.container.register(a),b(null,a)}),!b.function(e)){var h;return a.waterfall(g,{blocking:!0},function(a,b){a&&D(a),h=a||b}),h}a.waterfall(g,function(a,b){a&&D(a),e(a,b)})}function h(a,b){return i(a,a,b)}function i(c,d,e){var f={context:C,config:G,name:c,relyingName:d},g=[];if(g.push(function(a){a(null,f)}),g.push(function(a,c){b.string(a.name)?c(null,a):c(new o({type:m.errorTypes.INVALID_ARG,error:new Error(m.api.RESOLVE_ARG+JSON.stringify(a.name))}))}),g.push(function(a,b){a.context.singletonContainer.exists(a.name)?(a.resolved=C.singletonContainer.resolve(a.name),a.isResolved=!0,a.registerSingleton=!1,b(null,a)):C.container.exists(a.name)?(a.theModule=C.container.resolve(a.name),b(null,a)):b(new o({type:m.errorTypes.MODULE_NOT_FOUND,error:new Error(m.api.RESOLVE_ARG),data:{moduleName:a.name,relyingModuleName:a.relyingName}}))}),g.push(function(c,d){var e;return c.isResolved?d(null,c):b.array(c.theModule.dependencies)&&c.theModule.dependencies.length>0?(e=c.theModule.dependencies.map(function(a){return function(b,c,d){var e=i(a,c);if(e.isException)return d(e);b.push(e),d(null,b,c)}}),e.unshift(function(a){a(null,[],c.relyingName)}),a.waterfall(e,function(a,b){if(a)return d(a);c.resolved=c.theModule.factory.apply(null,b),c.registerSingleton=c.theModule.singleton,c.isResolved=!0,d(null,c)})):(b.function(c.theModule.factory)&&0===c.theModule.factory.length?c.resolved=c.theModule.factory.call():c.resolved=c.theModule.factory,c.registerSingleton=c.theModule.singleton,c.isResolved=!0,void d(null,c))}),g.push(function(a,b){a.registerSingleton&&C.singletonContainer.register({name:a.name,factory:a.resolved}),b(null,a)}),g.push(function(a,b){void 0===a.resolved&&a.config.onResolveUndefined(m.api.MODULE_UNDEFINED+a.name),b(null,a)}),g.push(function(a,b){b(null,a.resolved)}),!b.function(e)){var h;return a.waterfall(g,{blocking:!0},function(a,b){if(a&&a.type===m.errorTypes.MODULE_NOT_FOUND&&C.parent)return t[C.parent].resolveOne(c,d);a&&D(a),h=a||b}),h}a.waterfall(g,function(a,b){if(a&&a.type===m.errorTypes.MODULE_NOT_FOUND&&C.parent)return t[C.parent].resolveOne(c,d,e);a&&D(a),e(a,b)})}function l(a){return C.container.exists(a)}function s(a,b){return z(function(){return C.container.dispose(a)&&C.singletonContainer.dispose(a)},b)}function u(a,b,c){return b=b||{},b.parent=w(b.parent||B),z(function(){return r.scope(a,b)},new Error,c)}function v(a){var b=w(a);return b?C=C.setParentScope(b):new o({type:m.errorTypes.INVALID_ARG,error:new Error(m.api.PARENT_CONTAINER_ARG)})}function w(a){return a?b.string(a)?a:a.__isHilaryScope?a.context.scope:null:null}function x(c,d){var e,f=[];c=c||{},e=b.function(c.onComposed)?c.onComposed:b.function(d)?d:function(a){a&&F.fatal(a)},f.push(function(a){a(null,B)}),b.function(c.composeModules)&&f.push(c.composeModules),a.waterfall(f,e)}function y(){var a;if(E)return E;try{a=B.resolve(f),E=a&&b.function(a.throw)?a:{throw:function(a){F.error(a)}}}catch(a){F.warn(a)}}function z(c,d,e){if(b.function(e))a.runAsync(function(){try{e(null,c())}catch(a){d.message+="("+a.message+")",d.cause=a,D(d),e(d)}});else try{return c()}catch(a){d.message+="("+a.message+")",d.cause=a,D(d),e(d)}}function A(a){var c=b.object(a)?a:{};return b.string(a)?c.scope=a:a&&!b.nullOrUndefined(a.scope)||(b.string(a.name)?c.scope=a.name:c.scope=k.createUid(8)),a&&b.function(a.onResolveUndefined)?c.onResolveUndefined=a.onResolveUndefined:c.onResolveUndefined=F.warn,c}var B,C,D,E,F=new n(d),G=new A(d);return C=new p(G),B={register:e,resolve:h,exists:l,dispose:s,bootstrap:x,scope:u,setParentScope:v},c(B,"__isHilaryScope",!0),c(B,"context",C),G.hilaryCompatible&&(B.autoRegister=e,B.Bootstrapper=x),G.name&&(t[G.name]=B),D=function(a){var b;b=a.isException?a:new o({type:"UNKNOWN",error:a}),y().throw(b)},B},r.scope=function(a,b){return t[a]?t[a]:(b=b||{},b.name=a,t[a]=new r(b),t[a])},s=r.scope("default"),s.context.singletonContainer.register({name:d,factory:a}),s.context.singletonContainer.register({name:e,singleton:!1,factory:function(){return s.context}}),s.context.singletonContainer.register({name:g,factory:l}),s.context.singletonContainer.register({name:h,factory:b}),s.context.singletonContainer.register({name:i,factory:function(){return s.context.parent}}),s}function c(a,b,c){Object.defineProperty(a,b,{enumerable:!1,configurable:!1,get:function(){return c},set:function(){console.log(b+" is read only")}})}var d="polyn::async",e="hilary::context",f="hilary::error-handler",g="polyn::Immutable",h="polyn::is",i="hilary::parent",j={};j[d]=!0,j["hilary::bootstrapper"]=!0,j[e]=!0,j[g]=!0,j[h]=!0,j[i]=!0,function(a){try{if("undefined"!=typeof module&&module.exports)module.exports=a.factory;else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");window.__hilary=window.__hilary||{},window.__hilary[a.name]=a.factory}}catch(d){var b=a&&a.name?a.name:"MISSING NAME",c=new Error("[HILARY] Registration failure: "+b);throw c.cause=d,c}}({name:"HilaryApi",factory:b})}(),"undefined"!=typeof module&&module.exports){var polyn=require("polyn"),locale=require("./locale"),Exception=require("./Exception"),Container=require("./Container")(locale,polyn.is,polyn.Immutable,Exception),Context=require("./Context")(polyn.Immutable,Container),HilaryModule=require("./HilaryModule")(polyn.is,polyn.Immutable,polyn.objectHelper),Logger=require("./Logger")(polyn.is),HilaryApi=require("./HilaryApi")(polyn.async,polyn.is,polyn.id,polyn.Immutable,locale,Logger,Exception,Context,HilaryModule);module.exports=HilaryApi}else{if("undefined"==typeof window)throw new Error("[HILARY] Unkown runtime environment");if(!window.polyn)throw new Error("[HILARY] Hilary depends on polyn. Make sure it is included before loading Hilary (https://github.com/losandes/polyn)");if(!window.__hilary)throw new Error("[HILARY] Hilary modules were loaded out of order");!function(a,b,c){"use strict";var d=b.locale,e=b.Exception,f=b.Container(d,a.is,a.Immutable,e),g=b.Context(a.Immutable,f),h=b.HilaryModule(a.is,a.Immutable,a.objectHelper),i=b.Logger(a.is),j=b.HilaryApi(a.async,a.is,a.id,a.Immutable,d,i,e,g,h);c.Hilary=j}(window.polyn,window.__hilary,window)}